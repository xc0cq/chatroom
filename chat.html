<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Chat Room</title>
    <style>
        body {
            background: linear-gradient(135deg, #000000, #8B0000);
            font-family: Arial, sans-serif;
            color: white;
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        #messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        .message {
            margin: 5px 0;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 6px;
        }
        #input-area {
            display: flex;
            padding: 10px;
            background: #1a1a1a;
        }
        #input-area input {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 6px;
            outline: none;
        }
        #input-area button {
            margin-left: 10px;
            background: #ff4d4d;
            border: none;
            color: white;
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="messages"></div>
    <div id="input-area">
        <input id="messageInput" type="text" placeholder="Type a message..." />
        <button onclick="sendMessage()">Send</button>
    </div>

    <!-- Firebase Compat SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        // Your Firebase config (replace databaseURL with your Realtime DB URL)
        const firebaseConfig = {
            apiKey: "AIzaSyC-9Hk4TBPi4WLb4anO-84FDpIfjH8X8HY",
            authDomain: "chatting-f1958.firebaseapp.com",
            databaseURL: "https://chatting-f1958-default-rtdb.firebaseio.com",
            projectId: "chatting-f1958",
            storageBucket: "chatting-f1958.appspot.com",
            messagingSenderId: "308400029505",
            appId: "1:308400029505:web:a265599a58f1881e83abc0"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const username = localStorage.getItem("chatUser");
        if (!username) {
            window.location.href = "index.html";
        }

        const messagesRef = db.ref("messages");

        function sendMessage() {
            const text = document.getElementById("messageInput").value;
            if (text.trim() !== "") {
                messagesRef.push({
                    user: username,
                    text: text
                });
                document.getElementById("messageInput").value = "";
            }
        }

        messagesRef.on("child_added", snapshot => {
            const msg = snapshot.val();
            const msgDiv = document.createElement("div");
            msgDiv.classList.add("message");
            msgDiv.textContent = `${msg.user}: ${msg.text}`;
            document.getElementById("messages").appendChild(msgDiv);
            document.getElementById("messages").scrollTop = document.getElementById("messages").scrollHeight;
        });
    </script>
</body>
</html>